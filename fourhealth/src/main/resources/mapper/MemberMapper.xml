<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fourhealth.mapper.MemberMapper">

	<!--공통 회원데이터 resultMap  -->
    <resultMap type="CommonUserDto" id="resultMapMember">
        <result column="user_id" property="userId"/>
        <result column="user_pw" property="userPw"/>
        <result column="user_level_code" property="userLevelCode"/>
        <result column="user_name" property="userName"/>
        <result column="user_addr" property="userAddr"/>
         <result column="user_email" property="userEmail"/>
        <result column="user_nickname" property="userNickname"/>
        <result column="user_birth" property="userBirth"/>
        <result column="user_gender" property="userGender"/>
        <result column="user_main_bank" property="userMainBank"/>
        <result column="user_bank_number" property="userBankNumber"/>
        <result column="user_bank_master" property="userBankMaster"/>
        <result column="user_reg_date" property="userRegDate"/>
    </resultMap>
    
  
    
   <!-- 전체 회원 조회 -->
	<select id="viewMember" resultMap="resultMapMember" >
	SELECT
			user_id, 
			user_level_code, 
			user_pw, 
			user_name, 
			user_addr, 
			user_nickname, 
			user_phone, 
			user_email, 
			user_birth, 
			user_gender, 
			user_main_bank, 
			user_bank_number, 
			user_bank_master, 
			user_reg_date
	FROM 
		tb_common_user;
	</select>
	
	
	<select id="getMemberById" parameterType="String" resultMap="resultMapMember">
	SELECT
			user_id, 
			user_level_code, 
			user_pw, 
			user_name, 
			user_addr, 
			user_nickname, 
			user_phone, 
			user_email, 
			user_birth, 
			user_gender, 
			user_main_bank, 
			user_bank_number, 
			user_bank_master, 
			user_reg_date
		FROM 
			tb_common_user
		WHERE
			user_id = #{userId};
	</select>
	
	
		
	<!-- 아이디 중복 체크 : 아이디가 있으면 1 count, 없으면 0 -->
	<select id = "memberIdCheck" parameterType="String" resultType="int">
	SELECT 
		COUNT(*) 
	FROM tb_common_user AS u
		WHERE u.user_id = #{userId};
	</select>
	
	
	<!-- 회원가입 -->
	<insert id="addMember" parameterType="CommonUserDto">
		INSERT INTO tb_common_user
			(user_id, 
			user_level_code, 
			user_pw, 
			user_name, 
			user_addr, 
			user_nickname, 
			user_phone, 
			user_email, 
			user_birth, 
			user_gender, 
			user_main_bank, 
			user_bank_number, 
			user_bank_master, 
			user_reg_date)
	VALUES (
			#{userId}, 
			#{userLevel}, 
			#{userPw}, 
			#{userName}, 
			#{userAddr}, 
			#{userNickname}, 
			#{userPhone}, 
			#{userEmail}, 
			#{userBirth},
			#{userGender}, 
			null, 
			null, 
			null, 
			NOW());
	</insert>
	
	<!--  	 일단 생략
	<select id="trainerGetMatchingUserList" parameterType="String" resultMap="resultMapNoticePromotionTrainer">
	SELECT
		mut.trainer_user_matching_code AS 'trainerUserMatchingCode',
		mut.user_id AS 'userId'
	FROM
		tb_matching_user_trainer AS mut
	INNER JOIN
		tb_notice_promotion_trainer AS npt
	ON
		mut.trainer_promotion_notice_code = npt.trainer_promotion_notice_code
	where 
		mut.trainer_promotion_notice_code =#{promotionCode};
	</select>
	 -->
	
</mapper>